from ete3 import Tree
#from willowtree import *

t1_str = '(((((cell1:0.009,(cell9:0.003,cell10:0.003)ancestor31:0.006)ancestor15:0.004,((cell11:0.008,(cell27:0.004,cell28:0.004)ancestor55:0.004)ancestor32:0.003,(((cell57:0.003,cell58:0.003)ancestor85:0.001,(cell59:0.004,cell60:0.004)ancestor86:0.0)ancestor56:0.005,(cell29:0.008,cell30:0.008)ancestor57:0.001)ancestor33:0.002)ancestor16:0.002)ancestor7:0.015,((cell2:0.006,(cell12:0.0,(cell31:0.0,cell32:0.0)ancestor58:0.0)ancestor34:0.005)ancestor17:0.013,((cell13:0.007,(cell33:0.005,cell34:0.005)ancestor59:0.002)ancestor35:0.009,(cell14:0.007,(cell35:0.004,(cell61:0.003,(cell91:0.003,(cell120:0.002,cell121:0.002)ancestor141:0.001)ancestor115:0.0)ancestor87:0.001)ancestor60:0.003)ancestor36:0.009)ancestor18:0.002)ancestor8:0.009)ancestor3:0.028,(((cell3:0.014,(cell15:0.011,(cell36:0.003,(cell62:0.001,(cell92:0.0,cell93:0.0)ancestor116:0.001)ancestor88:0.002)ancestor61:0.008)ancestor37:0.003)ancestor19:0.013,(((cell37:0.005,(cell63:0.0,cell64:0.0)ancestor89:0.004)ancestor62:0.001,(cell38:0.005,(cell65:0.004,cell66:0.004)ancestor90:0.001)ancestor63:0.001)ancestor38:0.016,((cell39:0.001,cell40:0.001)ancestor64:0.006,((cell67:0.001,cell68:0.001)ancestor91:0.004,(cell69:0.003,(cell94:0.003,(cell122:0.002,(cell149:0.002,(cell167:0.001,(cell185:0.0,cell186:0.0)ancestor197:0.001)ancestor181:0.001)ancestor164:0.0)ancestor142:0.001)ancestor117:0.001)ancestor92:0.002)ancestor65:0.001)ancestor39:0.016)ancestor20:0.005)ancestor9:0.007,(((cell16:0.005,(cell41:0.004,(cell70:0.0,cell71:0.0)ancestor93:0.004)ancestor66:0.0)ancestor40:0.018,((cell42:0.0,cell43:0.0)ancestor67:0.014,(cell44:0.002,(cell72:0.002,(cell95:0.001,cell96:0.001)ancestor118:0.001)ancestor94:0.0)ancestor68:0.012)ancestor41:0.009)ancestor21:0.006,((cell17:0.009,(cell45:0.003,(cell73:0.001,(cell97:0.0,cell98:0.0)ancestor119:0.001)ancestor95:0.003)ancestor69:0.006)ancestor42:0.018,(cell18:0.02,(cell46:0.001,cell47:0.001)ancestor70:0.019)ancestor43:0.007)ancestor22:0.002)ancestor10:0.005)ancestor4:0.022)ancestor1:0.124,((((((cell48:0.002,cell49:0.002)ancestor71:0.007,((cell74:0.003,cell75:0.003)ancestor96:0.003,(cell76:0.004,((cell123:0.001,cell124:0.001)ancestor143:0.002,(cell125:0.002,cell126:0.002)ancestor144:0.001)ancestor120:0.001)ancestor97:0.002)ancestor72:0.004)ancestor44:0.007,((cell50:0.008,((cell99:0.001,(cell127:0.0,cell128:0.0)ancestor145:0.001)ancestor121:0.003,(cell100:0.001,(cell129:0.0,cell130:0.0)ancestor146:0.001)ancestor122:0.002)ancestor98:0.005)ancestor73:0.003,(cell51:0.009,(cell77:0.0,(cell101:0.0,cell102:0.0)ancestor123:0.0)ancestor99:0.009)ancestor74:0.002)ancestor45:0.005)ancestor23:0.071,(cell4:0.049,((((cell103:0.001,cell104:0.001)ancestor124:0.007,(cell105:0.004,((cell150:0.001,cell151:0.001)ancestor165:0.001,(cell152:0.001,cell153:0.001)ancestor166:0.001)ancestor147:0.002)ancestor125:0.004)ancestor100:0.004,(cell78:0.012,cell79:0.012)ancestor101:0.0)ancestor75:0.034,((cell80:0.006,(cell106:0.002,(cell131:0.0,cell132:0.0)ancestor148:0.002)ancestor126:0.004)ancestor102:0.03,(cell81:0.009,cell82:0.009)ancestor103:0.026)ancestor76:0.011)ancestor46:0.003)ancestor24:0.04)ancestor11:0.008,((cell5:0.023,(cell19:0.021,((((cell133:0.002,(cell154:0.001,(cell168:0.001,cell169:0.001)ancestor182:0.0)ancestor167:0.001)ancestor149:0.003,(cell134:0.004,cell135:0.004)ancestor150:0.001)ancestor127:0.006,(cell107:0.007,((cell155:0.001,(cell170:0.001,cell171:0.001)ancestor183:0.0)ancestor168:0.005,(cell156:0.004,(cell172:0.002,(cell187:0.002,cell188:0.002)ancestor198:0.0)ancestor184:0.002)ancestor169:0.003)ancestor151:0.001)ancestor128:0.005)ancestor104:0.009,((cell108:0.003,(cell136:0.002,cell137:0.002)ancestor152:0.0)ancestor129:0.01,(cell109:0.003,(cell138:0.001,cell139:0.001)ancestor153:0.003)ancestor130:0.01)ancestor105:0.007)ancestor77:0.001)ancestor47:0.002)ancestor25:0.069,((cell20:0.022,((cell83:0.002,cell84:0.002)ancestor106:0.012,(((cell140:0.002,cell141:0.002)ancestor154:0.003,(cell142:0.004,(cell157:0.001,cell158:0.001)ancestor170:0.003)ancestor155:0.001)ancestor131:0.003,((cell143:0.003,(cell159:0.003,(cell173:0.002,cell174:0.002)ancestor185:0.001)ancestor171:0.001)ancestor156:0.002,((cell160:0.0,cell161:0.0)ancestor172:0.003,(cell162:0.003,(cell175:0.001,cell176:0.001)ancestor186:0.003)ancestor173:0.0)ancestor157:0.002)ancestor132:0.002)ancestor107:0.006)ancestor78:0.008)ancestor48:0.063,((cell52:0.018,cell53:0.018)ancestor79:0.045,((cell85:0.002,(cell110:0.001,cell111:0.001)ancestor133:0.0)ancestor108:0.055,((((((cell189:0.006,(cell201:0.001,cell202:0.001)ancestor211:0.005)ancestor199:0.004,((cell203:0.003,cell204:0.003)ancestor212:0.006,((cell211:0.0,cell212:0.0)ancestor223:0.007,(cell213:0.005,cell214:0.005)ancestor224:0.002)ancestor213:0.003)ancestor200:0.001)ancestor187:0.009,(((cell205:0.001,(cell215:0.001,cell216:0.001)ancestor225:0.0)ancestor214:0.01,(cell206:0.009,(cell217:0.0,cell218:0.0)ancestor226:0.008)ancestor215:0.003)ancestor201:0.001,(cell190:0.012,cell191:0.012)ancestor202:0.0)ancestor188:0.007)ancestor174:0.011,((cell177:0.002,cell178:0.002)ancestor189:0.022,(cell179:0.007,(cell192:0.006,(cell207:0.004,cell208:0.004)ancestor216:0.002)ancestor203:0.0)ancestor190:0.017)ancestor175:0.007)ancestor158:0.006,((cell163:0.007,((cell193:0.0,cell194:0.0)ancestor204:0.005,(cell195:0.001,cell196:0.001)ancestor205:0.004)ancestor191:0.002)ancestor176:0.028,((cell180:0.014,(cell197:0.013,((cell219:0.003,(cell232:0.0,cell233:0.0)ancestor237:0.003)ancestor227:0.007,(cell220:0.009,(cell234:0.001,cell235:0.001)ancestor238:0.008)ancestor228:0.001)ancestor217:0.003)ancestor206:0.001)ancestor192:0.004,(((cell209:0.004,(cell221:0.001,cell222:0.001)ancestor229:0.003)ancestor218:0.006,((cell223:0.001,cell224:0.001)ancestor230:0.008,(cell225:0.006,((cell244:0.003,cell245:0.003)ancestor244:0.0,(cell246:0.003,(cell247:0.003,(cell248:0.0,(cell249:0.0,cell250:0.0)ancestor248:0.0)ancestor247:0.002)ancestor246:0.0)ancestor245:0.0)ancestor239:0.003)ancestor231:0.003)ancestor219:0.001)ancestor207:0.007,((((cell236:0.0,cell237:0.0)ancestor240:0.002,(cell238:0.001,cell239:0.001)ancestor241:0.001)ancestor232:0.004,(cell226:0.004,cell227:0.004)ancestor233:0.002)ancestor220:0.005,((cell228:0.001,cell229:0.001)ancestor234:0.01,(cell230:0.01,(cell240:0.005,cell241:0.005)ancestor242:0.004)ancestor235:0.001)ancestor221:0.0)ancestor208:0.006)ancestor193:0.001)ancestor177:0.017)ancestor159:0.001)ancestor134:0.018,((cell144:0.013,cell145:0.013)ancestor160:0.034,((cell164:0.01,(cell181:0.002,(cell198:0.001,cell199:0.001)ancestor209:0.002)ancestor194:0.008)ancestor178:0.011,((cell182:0.004,cell183:0.004)ancestor195:0.01,(cell184:0.012,(cell200:0.007,(cell210:0.003,(cell231:0.003,(cell242:0.001,cell243:0.001)ancestor243:0.002)ancestor236:0.001)ancestor222:0.004)ancestor210:0.005)ancestor196:0.002)ancestor179:0.008)ancestor161:0.025)ancestor135:0.007)ancestor109:0.002)ancestor80:0.008)ancestor49:0.022)ancestor26:0.006)ancestor12:0.005)ancestor5:0.038,(((cell6:0.003,(cell21:0.0,cell22:0.0)ancestor50:0.003)ancestor27:0.002,((cell23:0.003,(cell54:0.003,cell55:0.003)ancestor81:0.0)ancestor51:0.002,(cell24:0.004,(cell56:0.001,(cell86:0.001,cell87:0.001)ancestor110:0.0)ancestor82:0.002)ancestor52:0.001)ancestor28:0.001)ancestor13:0.105,((cell7:0.019,cell8:0.019)ancestor29:0.076,((cell25:0.001,cell26:0.001)ancestor53:0.043,(((cell88:0.004,cell89:0.004)ancestor111:0.002,((cell112:0.002,cell113:0.002)ancestor136:0.003,(cell114:0.005,(cell146:0.003,(cell165:0.001,cell166:0.001)ancestor180:0.002)ancestor162:0.001)ancestor137:0.001)ancestor112:0.0)ancestor83:0.019,(((cell115:0.001,cell116:0.001)ancestor138:0.001,(cell117:0.001,(cell147:0.0,cell148:0.0)ancestor163:0.001)ancestor139:0.0)ancestor113:0.017,(cell90:0.002,(cell118:0.0,cell119:0.0)ancestor140:0.002)ancestor114:0.017)ancestor84:0.006)ancestor54:0.019)ancestor30:0.051)ancestor14:0.016)ancestor6:0.023)ancestor2:0.045)founder;'
t2_str = '((((cell161:5.994157, cell160:0.005843):1.981977, ((cell174:0.000000, (cell173:0.000000, (cell159:0.000000, cell143:0.000000):0.000000):0.000000):1.992405, (cell176:0.000000, (cell175:0.000000, cell162:0.000000):0.000000):1.007595):0.018023):0.991418, ((cell84:0.000180, cell83:0.999820):2.972212, (((cell140:1.995674, (cell142:0.000000, (cell141:0.000000, (cell158:0.495469, cell157:3.504531):1.500000):0.000000):0.004326):1.463143, ((((((cell44:0.778777, (cell96:1.753599, (cell95:0.050902, cell72:0.000000):0.246401):2.221223):3.065220, ((cell41:2.004635, (cell16:2.538607, (cell71:2.940191, cell70:1.059809):4.461393):0.495365):1.030429, (cell43:2.984175, cell42:0.015825):0.969571):0.809780):0.924310, ((cell3:3.402802, ((cell17:3.312118, (cell45:0.995025, (cell73:0.988263, (cell98:0.000000, cell97:0.000000):0.011737):1.004975):2.687882):2.390995, (cell18:0.939063, (cell47:0.001894, cell46:0.998106):1.060938):0.609005):1.597198):0.232968, (((cell14:1.215047, (cell13:2.078326, ((cell34:0.996238, cell33:1.003762):4.965398, (cell35:1.163932, ((cell121:1.982068, cell120:0.017932):5.615652, (cell91:0.000000, cell61:1.000000):0.384348):0.836068):0.784602):0.046674):0.784953):0.667087, (((cell28:0.989209, (cell27:0.000000, cell11:3.000000):0.010791):1.693109, (((cell60:0.000000, cell59:2.000000):0.889946, (cell58:0.809821, cell57:0.190179):0.110054):1.159680, (cell30:0.000000, cell29:0.000000):0.090320):0.306891):0.829140, ((cell1:1.168658, (cell10:1.746875, cell9:1.253125):2.831342):1.884080, (cell2:0.000000, (cell12:0.000000, (cell32:1.999516, cell31:5.000484):0.000000):0.000000):1.115920):0.163047):0.321194):1.742233, ((((cell122:4.083792, ((cell186:0.000000, cell185:0.000000):1.860507, (cell167:0.013822, cell149:0.986178):0.139493):0.916208):3.381140, ((cell68:1.327022, cell67:1.672978):1.832106, (cell94:1.002833, cell69:2.997167):0.167894):0.150110):1.837946, (((cell37:2.008757, (cell64:0.977103, cell63:1.022897):2.991243):2.001953, (cell38:0.014757, (cell66:1.035912, cell65:2.964088):0.985243):0.998047):2.015745, (cell40:0.000000, cell39:0.000000):0.984255):0.232366):0.887111, ((cell93:1.973271, (cell92:1.000000, cell62:1.000000):0.026729):0.988062, (cell36:0.997948, cell15:0.002052):0.011938):0.148045):0.226517):0.217716):0.194220):4.151153, ((((cell26:0.000000, cell25:0.000000):2.287238, (((cell89:0.994681, cell88:0.005319):2.013618, ((cell113:2.174143, cell112:0.825857):0.880267, ((cell166:1.951872, cell165:1.048128):0.976170, (cell146:0.000000, cell114:0.000000):0.023830):0.119733):0.986382):1.435856, ((cell90:0.869104, (cell119:0.997881, cell118:0.002119):2.130896):4.113395, ((cell117:0.057780, (cell148:0.004587, cell147:0.995413):1.942220):0.966457, (cell116:1.000000, cell115:0.000000):0.033543):1.886605):1.298519):1.845574):0.849518, (cell8:1.999450, cell7:0.000550):0.150482):0.893697, ((cell6:0.881969, (cell22:0.000000, cell21:0.000000):1.118031):3.070305, ((cell24:0.994303, (cell56:0.000000, (cell87:0.000753, cell86:0.999247):0.000000):0.005697):1.997437, (cell55:0.999543, (cell54:0.000000, cell23:0.000000):0.000457):1.002563):0.929695):0.114115):1.089623):1.833935, ((cell4:0.118934, (((cell79:0.005076, cell78:0.994924):2.046220, ((cell153:0.000000, (cell152:0.000000, (cell151:0.000000, (cell150:0.000000, cell105:2.000000):0.000000):0.000000):0.000000):0.941026, (cell104:1.008769, cell103:0.991231):0.058974):1.953780):3.782344, ((cell131:0.980814, (cell80:0.019426, (cell132:1.489969, cell106:2.510031):0.480574):0.019186):0.975643, (cell82:1.000038, cell81:0.000000):0.024357):2.217656):0.881066):2.682697, (((cell77:1.965014, (cell102:0.000000, cell101:0.000000):1.034986):2.674009, (cell50:0.043689, (cell127:2.988249, (cell99:1.989704, (cell100:0.995090, (cell128:0.002810, (cell130:1.000000, cell129:0.000000):1.997190):0.004910):0.010296):0.011751):2.956311):1.825991):0.190670, ((cell49:0.000000, cell48:0.000000):1.962872, ((cell76:0.000000, ((cell124:1.000000, cell123:1.000000):0.999971, (cell126:0.000000, cell125:2.000000):0.000029):0.000000):0.994129, (cell51:0.000000, (cell75:0.000070, cell74:0.999930):2.000000):0.005871):0.037128):0.059330):0.857587):0.040272):0.100064, (cell5:2.002784, (((cell109:0.000706, (cell139:0.002277, cell138:0.997723):1.999294):4.029935, (cell137:0.999942, (cell136:0.000000, cell108:1.000000):0.000058):0.970065):1.969730, (cell19:0.998318, (((cell172:0.999763, (cell188:0.000000, cell187:0.000000):1.000237):1.495315, (cell156:0.977518, (cell107:3.003948, (cell170:0.999155, (cell171:0.000000, cell155:0.000000):0.000845):1.996052):0.022482):0.504685):0.496360, ((cell135:0.998698, cell134:0.001302):1.001759, (cell169:0.999444, (cell168:0.998912, (cell154:0.997873, cell133:0.002127):0.001088):0.000556):0.998241):0.003640):1.001682):0.081051):0.971825):0.034913):0.481287):0.414160, ((((cell210:0.187260, (cell231:0.382491, (cell243:1.856634, cell242:4.143366):0.617509):0.812740):3.469500, (cell200:2.000000, cell184:1.000000):0.405500):0.775325, (cell183:0.000000, cell182:0.000000):0.224675):0.905930, ((cell145:1.638424, (((cell197:1.935331, (cell234:1.545878, (cell220:0.007789, (cell235:0.000000, (cell219:1.014782, (cell233:0.995902, cell232:1.004098):1.985218):3.500000):0.242211):0.329122):3.127169):0.536694, (cell180:2.017857, (((cell222:2.994541, (cell221:2.002174, cell209:0.000000):0.005459):1.031374, ((cell248:1.590129, cell244:1.409871):0.456804, ((cell224:2.006276, cell223:0.993724):1.987653, (cell246:0.993194, ((cell250:0.000000, cell249:0.000000):1.995299, (cell247:0.000000, (cell245:0.000000, cell225:0.000000):0.000000):0.004701):0.006806):0.012347):0.043196):0.968626):2.064034, (((cell237:3.973469, (cell236:2.012195, (cell239:0.004032, cell238:0.995968):3.987805):0.026531):3.959201, (cell227:0.000000, cell226:0.000000):1.040799):1.780398, ((cell230:0.011303, (cell241:0.008488, cell240:0.991512):2.988697):1.988281, (cell229:1.000000, cell228:0.000000):1.011719):0.243040):1.830498):2.904018):0.520740):1.928381, (((cell206:0.812117, (cell218:0.000000, cell217:0.000000):1.187883):0.788526, ((cell191:0.000000, cell190:0.000000):2.352520, (cell205:3.219508, (cell216:1.943971, cell215:0.056029):2.280492):0.647480):0.273974):1.774461, (((cell179:0.793664, (cell192:2.018595, (cell208:0.000000, cell207:0.000000):1.981405):4.206336):4.435146, (cell178:1.794970, cell177:1.205030):0.564854):2.517524, ((((cell212:1.220556, cell211:1.779444):0.875846, (cell214:1.003145, cell213:0.996855):0.124154):0.935859, ((cell204:0.000000, cell203:0.000000):1.996818, (cell189:0.000391, (cell202:0.000714, cell201:0.999286):0.999609):1.003182):0.064141):1.032795, (cell163:1.132642, (cell195:2.771642, (cell196:0.995410, (cell194:0.000658, cell193:0.999342):1.004590):0.228358):1.867358):0.935955):0.220757):0.125930):0.113458):4.104618):0.323471, (cell164:4.991560, (cell144:0.996714, ((cell111:0.000000, (cell110:0.000000, cell85:1.000000):0.000000):1.999695, (cell198:0.991841, (cell199:0.000793, cell181:0.999207):0.008159):1.000305):0.003286):0.008440):0.058121):0.094344):0.776387):0.062699):0.023497):0.008469, (cell52:0.000000, cell20:0.000000):0.000340, cell53:2.999660);'

t1 = Tree(t1_str, format=1)
t2 = Tree(t2_str, format=1)
#t1 = Tree(newick=t1_str)
#t2 = Tree(newick=t2_str)
#t1.unroot()

#rf, mrf = robinson_foulds(t1, t2, rooted=False)
#rf, mrf, common_leaves, parts_t1, parts_t2
x = t1.robinson_foulds(t2, unrooted_trees=True)
rf, mrf = x[0], x[1]

c1, c2 = 0, 0

for node in t2.traverse():
    if node.is_leaf():
        c2 += 1
    else:
        c1 += 1

print(c1, c2)
